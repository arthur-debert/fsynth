#! /usr/bin/env bash

PROJECT_ROOT="$(pwd)"
LIB_NAME="fsynth"
LIB_ROOT="${PROJECT_ROOT}/${LIB_NAME}"
export LIB_NAME
export PROJECT_ROOT
export LIB_ROOT

# Export the project root for use in other scripts
export FSYNTH_ROOT="${PROJECT_ROOT}"

if [[ -d ".luarocks" ]]; then
    # Set test mode environment variable to suppress log output

    # Split the commands to avoid masking return values
    if LUAROCKS_BIN=$(command -v luarocks); then
        if LUAROCKS_PATH_RESULT=$("${LUAROCKS_BIN}" --tree "${PROJECT_ROOT}/.luarocks" path); then
            eval "${LUAROCKS_PATH_RESULT}"
        else
            echo "Warning: Failed to get LuaRocks path configuration" >&2
        fi
    else
        echo "Warning: LuaRocks not found in PATH" >&2
    fi
fi
